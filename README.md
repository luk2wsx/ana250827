# 廠長效率分析系統 - Excel檔案合併工具

這是一個使用Streamlit開發的Web應用程式，用於合併兩個Excel檔案並進行效率分析。系統會根據指定的欄位（如料號、工序等）進行資料比對和合併，並自動計算效率指標。

## 功能特色

- 📁 支援上傳兩個Excel檔案（.xlsx, .xls格式）
- 🔗 根據多個欄位進行資料合併
- 🧹 自動處理空白格（轉換為NaN並過濾）
- 📊 即時顯示檔案資訊和統計資料
- ⚡ 自動效率分析計算（實際CT、效率百分比）
- 🔍 智能資料過濾（排除異常值）
- 📈 效率統計分析（平均值、最高值、最低值、標準差）
- 📊 詳細視覺化圖表（效率分布圖、工站熱力圖、箱型圖、散點圖、排名圖）
- 🧠 進階分析功能（工站指標、效率異常、CT異常、個人排名）
- 💾 多種格式下載（CSV、HTML報告）
- 🎨 直觀的Web介面

## 安裝步驟

1. **安裝Python套件**
   ```bash
   pip install -r requirements.txt
   ```

2. **運行應用程式**
   ```bash
   streamlit run streamlit_app.py
   ```

3. **開啟瀏覽器**
   應用程式會在瀏覽器中自動開啟，通常是在 `http://localhost:8501`

## 使用說明

1. **上傳檔案**: 
   - 第一個檔案：工時資料（包含料號、工序、作業時間、工作內容等）
   - 第二個檔案：標準工時資料（包含料號、工序、產出、RUN總時數等）
2. **選擇合併欄位**: 選擇兩個檔案都有的欄位作為合併依據（建議選擇料號和工序）
3. **選擇合併方式**: 
   - `inner`: 只保留兩個檔案都有的記錄
   - `left`: 保留左邊檔案的所有記錄
   - `right`: 保留右邊檔案的所有記錄
   - `outer`: 保留所有記錄
4. **開始合併與分析**: 點擊「開始合併與分析」按鈕
5. **下載結果**: 下載完整合併結果和效率分析結果

## 系統需求

- Python 3.7+
- 支援的作業系統：Windows, macOS, Linux

## 注意事項

- 合併欄位必須在兩個Excel檔案中都存在
- 系統會自動將空白格轉換為NaN並過濾掉
- 建議使用料號和工序作為合併欄位
- 合併後的檔案會自動加上後綴（_檔案1, _檔案2）以區分來源
- 匯出格式為CSV，支援中文編碼（UTF-8 with BOM）
- 效率分析會自動過濾異常資料（效率20%-150%、排除特定人員等）
- 系統會自動重命名欄位以符合分析需求

## 自動處理功能

- **欄位重命名**: 自動將「作業時間」→「標工」、「工作內容」→「工站」、「產出」→「實際產出」、「RUN總時數」→「人員作業時間」
- **資料清理**: 自動去除空白並統一格式
- **效率計算**: 自動計算實際CT和效率百分比
- **資料過濾**: 自動過濾無效資料（效率20%-150%、排除特定人員等）
- **視覺化分析**: 自動生成多種圖表（效率分布、工站熱力圖、箱型圖、散點圖、排名圖）
- **進階分析**: 工站效率指標、效率異常分析、CT時間異常、個人效率排名
- **報告生成**: 自動生成HTML格式的詳細分析報告

## 技術架構

- **前端框架**: Streamlit
- **資料處理**: Pandas, NumPy
- **Excel處理**: openpyxl, xlrd
- **視覺化**: Plotly
- **報告生成**: Jinja2
